# ============================================================================
# SEARCH-API SERVICE - ENVIRONMENT CONFIGURATION
# ============================================================================
# This file contains all environment variables required by the search-api service.
# Copy this file to .env and update with your actual values.
#
# Usage: cp .env.example .env
#
# IMPORTANT: Never commit the .env file to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# SERVER CONFIGURATION
# ----------------------------------------------------------------------------
# Port where the search-api service will listen for HTTP requests
# Default: 8004 (to avoid conflicts with other microservices)
SERVER_PORT=8004

# ----------------------------------------------------------------------------
# MONGODB CONFIGURATION
# ----------------------------------------------------------------------------
# MongoDB connection string for storing denormalized trip data and geospatial indexes
# Local development: mongodb://localhost:27017
# Docker: mongodb://mongodb:27017
# Cloud (Atlas): mongodb+srv://username:password@cluster.mongodb.net/
MONGO_URI=mongodb://localhost:27017

# Database name for storing search data
# The service will create collections for trips, geospatial indexes, etc.
MONGO_DB=search_db

# ----------------------------------------------------------------------------
# APACHE SOLR CONFIGURATION
# ----------------------------------------------------------------------------
# Solr server base URL for full-text search capabilities
# Local development: http://localhost:8983/solr
# Docker: http://solr:8983/solr
SOLR_URL=http://localhost:8983/solr

# Solr core/collection name for indexing trip documents
# Must be created before starting the service (see README for setup)
SOLR_CORE=trips

# ----------------------------------------------------------------------------
# MEMCACHED CONFIGURATION
# ----------------------------------------------------------------------------
# Comma-separated list of Memcached server addresses for caching layer
# Local development: localhost:11211
# Docker: memcached:11211
# Multiple servers: server1:11211,server2:11211
MEMCACHED_SERVERS=localhost:11211

# Cache Time-To-Live in seconds (how long cached data remains valid)
# Default: 300 seconds (5 minutes)
# Recommended: 300-600 for frequently changing data, 3600+ for static data
CACHE_TTL=300

# ----------------------------------------------------------------------------
# RABBITMQ CONFIGURATION
# ----------------------------------------------------------------------------
# RabbitMQ connection URL for consuming events from trips-api
# Format: amqp://username:password@host:port/vhost
# Local development: amqp://guest:guest@localhost:5672/
# Docker: amqp://guest:guest@rabbitmq:5672/
RABBITMQ_URL=amqp://guest:guest@localhost:5672/

# Queue name for receiving trip events from trips-api
# This queue will receive events like: trip.created, trip.updated, trip.deleted
# Must match the queue name configured in trips-api publisher
QUEUE_NAME=search.events

# ----------------------------------------------------------------------------
# EXTERNAL API CONFIGURATION
# ----------------------------------------------------------------------------
# Trips API base URL for fetching trip details when needed
# Local development: http://localhost:8002
# Docker: http://trips-api:8002
TRIPS_API_URL=http://localhost:8002

# Users API base URL for fetching driver information and denormalization
# Local development: http://localhost:8001
# Docker: http://users-api:8001
USERS_API_URL=http://localhost:8001

# ----------------------------------------------------------------------------
# JWT AUTHENTICATION CONFIGURATION
# ----------------------------------------------------------------------------
# Secret key for validating JWT tokens from authenticated requests
# IMPORTANT: Use a strong, random secret in production (min 32 characters)
# Generate with: openssl rand -base64 32
# Must match the JWT_SECRET used by users-api for token validation
JWT_SECRET=your-secret-key-change-in-production

# ----------------------------------------------------------------------------
# APPLICATION ENVIRONMENT
# ----------------------------------------------------------------------------
# Application environment mode
# Values: development, dev, production, prod
# Affects logging level, error details, and performance optimizations
ENVIRONMENT=development

# ============================================================================
# DOCKER COMPOSE ALTERNATIVES
# ============================================================================
# When running with docker-compose, use these host names instead:
#
# MONGO_URI=mongodb://mongodb:27017
# SOLR_URL=http://solr:8983/solr
# MEMCACHED_SERVERS=memcached:11211
# RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
# TRIPS_API_URL=http://trips-api:8002
# USERS_API_URL=http://users-api:8001
# ============================================================================

# ============================================================================
# NOTES
# ============================================================================
# 1. SETUP REQUIREMENTS:
#    - MongoDB must be running before starting the service
#    - Apache Solr must be running with the 'trips' core created
#    - Memcached must be running for caching to work
#    - RabbitMQ must be running with proper queues configured
#    - trips-api must be configured to publish events to the queue
#
# 2. SOLR CORE SETUP:
#    Create the Solr core with:
#    curl "http://localhost:8983/solr/admin/cores?action=CREATE&name=trips&configSet=_default"
#
# 3. SECURITY:
#    - Change JWT_SECRET to a strong random value in production
#    - Use proper authentication for MongoDB, RabbitMQ, etc.
#    - Enable SSL/TLS for all external connections in production
#
# 4. PERFORMANCE TUNING:
#    - Adjust CACHE_TTL based on data freshness requirements
#    - Configure multiple MEMCACHED_SERVERS for high availability
#    - Monitor MongoDB indexes for query performance
#
# 5. MONITORING:
#    - Set ENVIRONMENT=production to enable production logging
#    - Use structured logs for better observability
#    - Monitor RabbitMQ queue depth for consumer lag
# ============================================================================
